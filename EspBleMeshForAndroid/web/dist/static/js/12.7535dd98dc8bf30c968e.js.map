{"version":3,"sources":["webpack:///src/pages/firstProvision.vue","webpack:///./src/pages/firstProvision.vue?08a8","webpack:///./src/pages/firstProvision.vue"],"names":["firstProvision","name","data","selected","selectList","blueEnable","locationGranted","locationEnabled","provisionNumber","getFastProvNodeAddrTimeOut","firstAddress","isBleConnect","getFirstContent","created","self","this","push","$t","window","res","meshMessageCallback","scanCallback","connectCallback","onBackPressed","methods","showBlueFail","console","log","utils","hide","$router","goBack","deviceProvision","sendMeshData","_isEmpty","messageRemind","$store","state","constant_default","a","KEY_OP_CODE","FAST_PROV_INFO_SET","KEY_DST_ADDRESS","bleConnectAddress","KEY_EXPECT_PROVISIONING_COUNT","stringify_default","mint_ui_common","open","setTimeout","close","sendMeshMessage","firstProvStatusCallback","getFastProvNodeAddr","FAST_PROV_NODE_ADDR_GET","homeDeviceScan","scanTimeout","sendBLEMeshData","getFastProvNodeAddrCallback","fastNodes","fastNodesStatus","clearTimeout","mounted","computed","getBlueEnable","blueInfo","pages_firstProvision","render","_vm","_h","$createElement","_c","_self","staticClass","on","click","_v","_s","directives","rawName","value","expression","$event","attrs","placeholder","type","domProps","input","target","composing","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/12.7535dd98dc8bf30c968e.js","sourcesContent":["<template>\r\n  <div class=\"content-box\">\r\n    <div class=\"title-info\">\r\n      <h4 class=\"app-title\"><span @click=\"hide\"><i class=\"icon-left back\"></i></span>{{$t('fastprovision')}}</h4>\r\n      <div v-show=\"!getBlueEnable\"  @click=\"showBlueFail\" class=\"bluetooth-second-base\">\r\n        <i class=\"icon-bluetooth bluetooth-second-style\"></i>\r\n      </div>\r\n      <span @click=\"deviceProvision()\" class=\"right-top-text\">{{$t('provision')}}</span>\r\n    </div>\r\n    <div class=\"input-base\">\r\n      <input class=\"input-content\" v-model=\"provisionNumber\" :placeholder=\"$t('configdevicenumber')\" type=\"number\">\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Constant from \"../assets/tool/constant\";\r\nimport Util from \"../assets/tool/utils\";\r\nimport {Indicator} from 'mint-ui'\r\nexport default {\r\n  name: 'text',\r\n  data () {\r\n    return {\r\n      selected: '',\r\n      selectList: [],\r\n      blueEnable: true,\r\n      locationGranted: true,\r\n      locationEnabled: true,\r\n      provisionNumber: '',\r\n      getFastProvNodeAddrTimeOut: '',\r\n      firstAddress: '',\r\n      isBleConnect: true,\r\n      getFirstContent: 0\r\n    }\r\n  },\r\n  created () {\r\n    var self = this\r\n    self.selectList.push(self.$t('allnodes'))\r\n    window['meshMessageCallback'] = (res) => {\r\n      self.meshMessageCallback(res)\r\n    }\r\n    window['scanCallback'] = (res) => {\r\n      self.scanCallback(res)\r\n    }\r\n    window['connectCallback'] = (res) => {\r\n      self.connectCallback(res)\r\n    }\r\n    window['onBackPressed'] = () => {\r\n      self.onBackPressed()\r\n    }\r\n  },\r\n  methods: {\r\n    showBlueFail () {\r\n      console.log('点击蓝牙按钮')\r\n    },\r\n    scanCallback (res) {\r\n      var self = this\r\n      Util.scanCallback(res, self)\r\n    },\r\n    connectCallback (res) {\r\n      var self = this\r\n      Util.connectCallback(res, self, true)\r\n    },\r\n    hide () {\r\n      this.$router.goBack()\r\n    },\r\n    onBackPressed () {\r\n      this.$router.goBack()\r\n    },\r\n    deviceProvision () {\r\n      var self = this\r\n      var sendMeshData = {}\r\n      console.log('配网数量： ' + self.provisionNumber)\r\n      if (!Util._isEmpty(self.provisionNumber)) {\r\n        self.isBleConnect = self.$store.state.isBleConnect\r\n        if (self.isBleConnect) {\r\n          sendMeshData[Constant.KEY_OP_CODE] = Constant.FAST_PROV_INFO_SET\r\n          sendMeshData[Constant.KEY_DST_ADDRESS] = self.$store.state.bleConnectAddress\r\n          sendMeshData[Constant.KEY_EXPECT_PROVISIONING_COUNT] = self.provisionNumber\r\n          self.firstAddress = self.$store.state.bleConnectAddress\r\n          console.log('FBY First provision sendMeshData:' + JSON.stringify(sendMeshData))\r\n          Indicator.open()\r\n          setTimeout(function () {\r\n            Indicator.close()\r\n            Util.messageRemind(self.$t('provisionTimeout'))\r\n          }, 30000)\r\n          Util.sendMeshMessage(self, sendMeshData)\r\n        } else {\r\n          Util.messageRemind(self.$t('bledisconnect'))\r\n          // self.hide()\r\n        }\r\n      } else {\r\n        Util.messageRemind(this.$t('configdevicenumber'))\r\n      }\r\n    },\r\n    meshMessageCallback (res) {\r\n      var self = this\r\n      Util.meshMessageCallback(res, self, 'firstProvision')\r\n    },\r\n    firstProvStatusCallback () {\r\n      // Indicator.close()\r\n      var self = this\r\n      self.getFastProvNodeAddrTimeOut = setTimeout(function () {\r\n        console.log('FBY getFastProvNodeAddrTimeOut aaaaa: ' + self.getFirstContent)\r\n        self.getFastProvNodeAddr()\r\n      }, 5000)\r\n      self.getFirstContent ++\r\n    },\r\n    getFastProvNodeAddr () {\r\n      var self = this\r\n      var sendMeshData = {}\r\n      self.isBleConnect = self.$store.state.isBleConnect\r\n      if (self.isBleConnect) {\r\n        sendMeshData[Constant.KEY_OP_CODE] = Constant.FAST_PROV_NODE_ADDR_GET\r\n        sendMeshData[Constant.KEY_DST_ADDRESS] = self.firstAddress\r\n        console.log('FBY First provision sendMeshData:' + JSON.stringify(sendMeshData))\r\n        Util.sendMeshMessage(self, sendMeshData)\r\n\r\n        if (self.getFirstContent < 3) {\r\n          self.getFastProvNodeAddrTimeOut = setTimeout(function () {\r\n            console.log('FBY getFastProvNodeAddrTimeOut: ' + self.getFirstContent)\r\n            self.getFastProvNodeAddr()\r\n          }, 5000)\r\n          self.getFirstContent ++\r\n        }\r\n      } else {\r\n        Util.messageRemind(self.$t('bledisconnect'))\r\n        Util.homeDeviceScan(this)\r\n      }\r\n    },\r\n    scanTimeout () {\r\n      var self = this\r\n      var isRemind = Util.scanTimeout(this)\r\n      if (isRemind) {\r\n        Util.messageRemind(self.$t('unconnectable'))\r\n      }\r\n    },\r\n    sendBLEMeshData () {\r\n      this.getFastProvNodeAddr()\r\n    },\r\n    getFastProvNodeAddrCallback (fastNodes) {\r\n      var self = this\r\n      self.getFirstContent = 5\r\n      Indicator.close()\r\n      Util.fastNodesStatus(self, fastNodes)\r\n      clearTimeout(self.getFastProvNodeAddrTimeOut)\r\n      Util.messageRemind(self.$t('fastconfigsuc'))\r\n    }\r\n  },\r\n  mounted () {\r\n    var self = this\r\n    // self.firstAddress = self.$store.state.bleConnectAddress\r\n    // this.getFastProvNodeAddr()\r\n  },\r\n  computed: {\r\n    getBlueEnable () {\r\n      console.log('状态实时更新')\r\n      this.blueEnable = this.$store.state.blueInfo\r\n      this.locationGranted = this.$store.state.locationGranted\r\n      this.locationEnabled = this.$store.state.locationEnabled\r\n      return this.blueEnable\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n  @import '../assets/css/index.less';\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/firstProvision.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content-box\"},[_c('div',{staticClass:\"title-info\"},[_c('h4',{staticClass:\"app-title\"},[_c('span',{on:{\"click\":_vm.hide}},[_c('i',{staticClass:\"icon-left back\"})]),_vm._v(_vm._s(_vm.$t('fastprovision')))]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.getBlueEnable),expression:\"!getBlueEnable\"}],staticClass:\"bluetooth-second-base\",on:{\"click\":_vm.showBlueFail}},[_c('i',{staticClass:\"icon-bluetooth bluetooth-second-style\"})]),_vm._v(\" \"),_c('span',{staticClass:\"right-top-text\",on:{\"click\":function($event){return _vm.deviceProvision()}}},[_vm._v(_vm._s(_vm.$t('provision')))])]),_vm._v(\" \"),_c('div',{staticClass:\"input-base\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.provisionNumber),expression:\"provisionNumber\"}],staticClass:\"input-content\",attrs:{\"placeholder\":_vm.$t('configdevicenumber'),\"type\":\"number\"},domProps:{\"value\":(_vm.provisionNumber)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.provisionNumber=$event.target.value}}})])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-158b5919\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/firstProvision.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-158b5919\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./firstProvision.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./firstProvision.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./firstProvision.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-158b5919\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./firstProvision.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-158b5919\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/firstProvision.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}